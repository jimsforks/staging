# Global variables don't seem to work
parameters:
  R_LIBS_USER: '$(Agent.BuildDirectory)/R/library'
  CRAN: 'https://cloud.r-project.org'

jobs:
- job: macOS
  pool:
    vmImage: macOS-10.13
  steps:
    - template: templates/r-setup-macos.yml
    - template: templates/stage-all.yml
  variables:
    BINEXT: .tgz
    CRAN: ${{parameters.CRAN}}
    R_LIBS_USER: ${{parameters.R_LIBS_USER}}

- job: Windows
  pool:
    vmImage: 'vs2017-win2016'
  steps:
    - template: templates/r-setup-windows.yml
    - template: templates/stage-all.yml
  variables:
    BINEXT: .zip
    CRAN: ${{parameters.CRAN}}
    R_LIBS_USER: ${{parameters.R_LIBS_USER}}

- job: Linux
  pool:
    vmImage: 'Ubuntu-16.04'
  container: rstudio/r-base:3.6-xenial
  steps:
    - template: templates/r-setup-linux.yml
    - template: templates/stage-all.yml
  variables:
    TZ: UTC
    BINEXT: pc-linux-gnu.tar.gz
    CRAN: ${{parameters.CRAN}}
    R_LIBS_USER: ${{parameters.R_LIBS_USER}}
