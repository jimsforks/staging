# Global variables don't seem to work
parameters:
  CRAN: 'https://cloud.r-project.org'

- job: Windows
  pool:
    vmImage: 'vs2017-win2016'
  steps:
    - template: templates/r-setup-windows.yml
    - template: templates/stage-all.yml
  variables:
    BINEXT: .zip
    R_LIBS: c:\R\library
    CRAN: ${{parameters.CRAN}}

jobs:
- job: macOS
  pool:
    vmImage: macOS-10.13
  steps:
    - template: templates/r-setup-macos.yml
    - template: templates/stage-all.yml
  variables:
    BINEXT: .tgz
    R_LIBS: /R/library
    CRAN: ${{parameters.CRAN}}

- job: Linux
  pool:
    vmImage: 'Ubuntu-16.04'
  container: rstudio/r-base:3.6-xenial
  steps:
    - template: templates/r-setup-linux.yml
    - template: templates/stage-all.yml
  variables:
    TZ: UTC
    BINEXT: pc-linux-gnu.tar.gz
    R_LIBS: /R/library
    CRAN: ${{parameters.CRAN}}
